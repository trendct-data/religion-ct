{
    "collab_server" : "",
    "contents" : "library(RColorBrewer)\n\ndf_county_demographics$value <- df_county_demographics$total_population\nchoro = CountyChoropleth$new(df_county_demographics)\nchoro$set_zoom(\"connecticut\")\nchoro$title = \"Where Do People in Connecticut Live?\"\nchoro$set_num_colors(1)\nchoro$ggplot_scale = scale_fill_gradientn(name = \"Population\", colours = brewer.pal(8, \"GnBu\"))\nchoro$render()\n\ndf_county_demographics$value <- df_county_demographics$median_rent\nchoro = CountyChoropleth$new(df_county_demographics)\nchoro$set_zoom(\"connecticut\")\nchoro$title = \"Median Rent in Connecticut Counties\"\nchoro$set_num_colors(1)\nchoro$ggplot_scale = scale_fill_gradientn(name = \"Median Rent ($)\", colours = brewer.pal(8, \"GnBu\"))\nchoro$render() + geom_text(data = data.frame(long = -72.926889, lat = 41.305532, label = \"hm\"),\n                           aes(long, lat, label = label, group = NULL), color = \"black\", size = 3)\n\ndf_county_demographics$value <- df_county_demographics$percent_white\nchoro = CountyChoropleth$new(df_county_demographics)\nchoro$set_zoom(\"connecticut\")\nchoro$title = \"How Much of Connecticut's Population Is White?\"\nchoro$set_num_colors(1)\nchoro$ggplot_scale = scale_fill_gradientn(name = \"Percent\", colours = brewer.pal(8, \"GnBu\"))\nchoro$render() + geom_text(data = data.frame(long = -72.926889, lat = 41.305532, label = \"Salt Lake\"),\n                           aes(long, lat, label = label, group = NULL), color = \"black\", size = 3)\n\ncounties <- counties[counties$STABBR == \"CT\",]\ncounties$CNTYNAME <- as.character(counties$CNTYNAME)\ncounties$CNTYNAME <- sub(\"County\", \"\", counties$CNTYNAME)\ncounties$CNTYNAME <- sub(\"\\\\s+$\", \"\", counties$CNTYNAME)\n\ncounties <- counties[,!sapply(counties, function(x) all(is.na(x)))]\n\nmyDF <- as.data.frame(cbind(counties$CNTYNAME, counties$FIPS, counties$POP2010, \n                            counties$TOTRATE, counties$LDSRATE, counties$MPRTRATE, \n                            counties$EVANRATE, counties$CATHRATE, counties$OTHRATE, \n                            counties$ORTHRATE, counties$BPRTRATE))\ncolnames(myDF) <- c(\"county\", \"region\", \"population\", \"total\", \"LDS\", \n                    \"mainline\", \"evangelical\", \"catholic\", \"originalother\", \n                    \"orthodox\", \"blackprot\")\nmyDF[,2:11] <- lapply(myDF[,2:11], as.character)\nmyDF[,2:11] <- lapply(myDF[,2:11], as.numeric)\nmyDF[is.na(myDF)] <- 0\n\nmyDF <- mutate(myDF, other = (originalother - LDS + orthodox + blackprot))\nmyDF <- mutate(myDF, allchurchytypes = \n                 (LDS + mainline + evangelical + catholic + other))\nmyDF <- mutate(myDF, difference = (total - allchurchytypes))\nc(mean(myDF$difference), sd(myDF$difference))\n\nmyDF <- mutate(myDF, unclaimed = (1000. - allchurchytypes))\n\nmyDF$value <- myDF$LDS\nchoro = CountyChoropleth$new(myDF)\nchoro$set_zoom(\"connecticut\")\nchoro$title = \"LDS Adherents by County\"\nchoro$set_num_colors(1)\nchoro$ggplot_scale = scale_fill_gradientn(name = \"Adherence rate\\n(per 1000 population)\", \n                                          colours = brewer.pal(8, \"YlGnBu\"))\nchoro$render() + geom_text(data = data.frame(long = -72.926889, lat = 41.305532, label = \"Salt Lake\"),\n                           aes(long, lat, label = label, group = NULL), color = \"black\", size = 3)\n\n\nmyDF$value <- myDF$unclaimed\nchoro = CountyChoropleth$new(myDF)\nchoro$set_zoom(\"connecticut\")\nchoro$title = \"Nonadherents by County\"\nchoro$set_num_colors(1)\nchoro$ggplot_scale = scale_fill_gradientn(name = \"Nonadherence rate\\n(per 1000 population)\", \n                                          colours = brewer.pal(8, \"YlGnBu\"))\nchoro$render() + geom_text(data = data.frame(long = -72.926889, lat = 41.305532, label = \"Salt Lake\"),\n                           aes(long, lat, label = label, group = NULL), color = \"black\", size = 3)\n\nlibrary(gridExtra)\nmyDF$value <- myDF$catholic\nchoro1 = CountyChoropleth$new(myDF)\nchoro1$set_zoom(\"connecticut\")\nchoro1$title = \"Catholics by County\"\nchoro1$set_num_colors(1)\nchoro1$ggplot_scale = scale_fill_gradientn(name = \"Adherence rate\\n(per 1000 population)\", \n                                           colours = brewer.pal(8, \"YlGnBu\"))\nmyDF$value <- myDF$evangelical\nchoro2 = CountyChoropleth$new(myDF)\nchoro2$set_zoom(\"connecticut\")\nchoro2$title = \"Evangelicals by County\"\nchoro2$set_num_colors(1)\nchoro2$ggplot_scale = scale_fill_gradientn(name = \"Adherence rate\\n(per 1000 population)\", \n                                           colours = brewer.pal(8, \"YlGnBu\"))\n\ngrid.arrange(choro1$render(), choro2$render(), ncol = 2)\n\n\n#\n\nlibrary(reshape2)\nmeltedDF <- melt(myDF[,c(1,5:8,12,15)])\ncolnames(meltedDF) <- c(\"county\", \"religion\", \"rate\")\nmeltedDF$religion <- as.factor(meltedDF$religion)\nmeltedDF$religion <- factor(meltedDF$religion,\n                            levels(meltedDF$religion)[c(1,6,4,3,5,2)])\n\nggplot(meltedDF[(meltedDF$county == \"Hartford\"| meltedDF$county == \"Fairfield\"),], \n       aes(x = religion, y = rate, group = county, fill = religion)) +\n  geom_bar(stat = \"identity\") + \n  facet_wrap(~county, ncol = 2) +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme(legend.position=\"none\", axis.title.x = element_blank()) +\n  ylab(\"Adherence rate (per 1000 population)\") + \n  ggtitle(\"Two Most Populous Counties In Connecticut\") +\n  scale_x_discrete(labels=c(\"LDS\", \"Unclaimed\", \"Catholic\", \"Evangelical\",\n                            \"Mainline\", \"Other\"))\n\nggplot(meltedDF, aes(x = religion, y = rate, group = county, fill = religion)) +\n  geom_bar(stat = \"identity\") + \n  facet_wrap(~county, ncol = 6) +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme(legend.position=\"none\", axis.title.x = element_blank(), \n        axis.text.x= element_text(angle=45, hjust = 1)) +\n  ylab(\"Adherence rate (per 1000 population)\") + \n  ggtitle(\"Religions in Connecticut Counties\") +\n  scale_x_discrete(labels=c(\"LDS\", \"Unclaimed\", \"Catholic\", \"Evangelical\",\n                            \"Mainline\", \"Other\"))",
    "created" : 1455923292314.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "730313866",
    "id" : "BDA2E9E8",
    "lastKnownWriteTime" : 1473511455,
    "last_content_update" : 1473511455856,
    "path" : "~/Documents/Github/trendct-data/2016/02/religion-ct/viz2.R",
    "project_path" : "viz2.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}